<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>innodb_index_rows: common_schema documentation</title>
	<meta name="description" content="innodb_index_rows: common_schema" />
	<meta name="keywords" content="innodb_index_rows: common_schema" />
	<link rel="stylesheet" type="text/css" href="style.css" />
</head>

<body>
	<div id="main">
		<div id="header">
			<h1>common_schema documentation</h1>
			<div class="subtitle">Common views & routines for MySQL</div>
		</div>
		<div id="contentwrapper">
			<div id="content">
				<h2><a href="innodb_index_rows.html">innodb_index_rows</a></h2>	
<h3>NAME</h3>
innodb_index_rows: Number of row cardinality per keys per columns in InnoDB tables
<h3>TYPE</h3>
View

<h3>DESCRIPTION</h3>

<p><i>innodb_index_rows</i> extends the <a href="http://www.percona.com/docs/wiki/percona-server:features:innodb_stats#innodb_index_stats">INNODB_INDEX_STATS</a> patch
in Percona Server, and presents with information on InnoDB keys cardinality as per indexed column.
</p>

<p>
The Percona Server INNODB_INDEX_STATS table presents with cardinality values per index, per indexed column. 
That is, it lets us know the average number of rows expected to be found in an index for some key.
</p>

<p>For single column keys, this is simple enough. However, for compound indexes (indexes over multiple columns), this information becomes even more
interesting, as it lets us examine the reduction in cardinality per column. However, the Percona Server patch only informs us with numbers. 
</p>

<p><i>innodb_index_rows</i> extends that information and adds column information. It lists column names and their sequence within the key,
and provides with easier read.</p>

<p>This view depends upon the <a href="http://www.percona.com/docs/wiki/percona-server:features:innodb_stats#innodb_index_stats">INNODB_INDEX_STATS</a> patch
in Percona Server. Note that as of Percona Server 5.5.8-20.0 the schema of the INNODB_INDEX_STATS is incompatible with earlier releases, and is not yet supported. 
</p>

<h3>STRUCTURE</h3>

<blockquote><pre>
mysql&gt; DESC common_schema.innodb_index_rows;
+-------------------------+--------------+------+-----+---------+-------+
| Field                   | Type         | Null | Key | Default | Extra |
+-------------------------+--------------+------+-----+---------+-------+
| TABLE_SCHEMA            | varchar(64)  | NO   |     |         |       |
| TABLE_NAME              | varchar(64)  | NO   |     |         |       |
| INDEX_NAME              | varchar(64)  | NO   |     |         |       |
| SEQ_IN_INDEX            | bigint(2)    | NO   |     | 0       |       |
| COLUMN_NAME             | varchar(64)  | NO   |     |         |       |
| incremental_row_per_key | varchar(256) | NO   |     |         |       |
+-------------------------+--------------+------+-----+---------+-------+
</pre></blockquote>

<h3>SYNOPSIS</h3>

<p>Columns of this view:</p>
<ul>
	<li><strong>TABLE_SCHEMA</strong>: Table schema of examined index</li>
	<li><strong>TABLE_NAME</strong>: Examined index' table</li>
	<li><strong>INDEX_NAME</strong>: name of index examined</li>
	<li><strong>SEQ_IN_INDEX</strong>: position of column within index (<strong>1</strong> based)</li>
	<li><strong>COLUMN_NAME</strong>: name of column within index</li>
	<li><strong>incremental_row_per_key</strong>: Cardinality (number of values per key) of index up to and including current column</li>
</ul>

<h3>EXAMPLES</h3>
<p>Examine index cardinality on a specific table:</p>
<blockquote><pre>mysql&gt; SELECT * FROM common_schema.innodb_index_rows WHERE TABLE_NAME='docs_template';
+--------------+---------------+-----------------+--------------+---------------------+-------------------------+
| TABLE_SCHEMA | TABLE_NAME    | INDEX_NAME      | SEQ_IN_INDEX | COLUMN_NAME         | incremental_row_per_key |
+--------------+---------------+-----------------+--------------+---------------------+-------------------------+
| databus      | docs_template | PRIMARY         |            1 | doc_id              | 1                       |
| databus      | docs_template | unique_docs_idx |            1 | origin_id           | 28697765                |
| databus      | docs_template | unique_docs_idx |            2 | doc_published       | 28697765                |
| databus      | docs_template | unique_docs_idx |            3 | uniq_indicator      | 1                       |
| databus      | docs_template | unique_docs_idx |            4 | info                | 1                       |
| databus      | docs_template | doc_timestamp   |            1 | doc_timestamp       | 12                      |
+--------------+---------------+-----------------+--------------+---------------------+-------------------------+
</pre></blockquote>

<p>Compare with call to INFORMATION_SCHEMA.INNODB_INDEX_STATS:</p>
<blockquote><pre>mysql&gt; SELECT * FROM INFORMATION_SCHEMA.INNODB_INDEX_STATS WHERE TABLE_NAME='docs_template';
+--------------+---------------+---------------------+--------+--------------------------+------------+------------+
| table_schema | table_name    | index_name          | fields | row_per_keys             | index_size | leaf_pages |
+--------------+---------------+---------------------+--------+--------------------------+------------+------------+
| databus      | docs_template | PRIMARY             |      1 | 1                        |   18851201 |   16485198 |
| databus      | docs_template | unique_docs_idx     |      4 | 28697765, 28697765, 1, 1 |     834310 |     725102 |
| databus      | docs_template | doc_timestamp       |      2 | 12, 1                    |     127577 |     126428 |
+--------------+---------------+---------------------+--------+--------------------------+------------+------------+
</pre></blockquote>
<p>
Note the following:
<ul>
	<li>The <i>PRIMARY</i> key is on <i>doc_id</i>, hence contains one column exactly. Since it is UNIQUE, it is certain to have <strong>1</strong> row per key.</li>
	<li>The <i>unique_docs_idx</i> key is a UNIQUE key over four columns. The INFORMATION_SCHEMA.INNODB_INDEX_STATS table tells us that for 1st and 2nd columns,
	cardinality is <strong>28697765</strong>. Only at 3rd and 4th columns does cardinality per key drop to <strong>1</strong>.</li>
	<li>The <i>doc_timestamp</i> index is non unique. The INFORMATION_SCHEMA.INNODB_INDEX_STATS table lists two values for that column, although it only indexes one column only.
	This is because it implicitly includes the PRIMARY key for that table (as with all InnoDB keys). However, in <i>innodb_index_rows</i> only the explicitly indexed columns are listed.</li>
</ul>
</p>

<h3>ENVIRONMENT</h3>
Percona Server &lt; 5.5.8-20.0 with <a href="http://www.percona.com/docs/wiki/percona-server:features:innodb_stats#innodb_index_stats">INNODB_INDEX_STATS patch</a>

<h3>SEE ALSO</h3>
<a href="innodb_index_stats.html">innodb_index_stats</a>
<h3>AUTHOR</h3>
Shlomi Noach
				<br/>
			</div>
			<div id="sidebarwrapper">
				<div id="menu">
					<ul>
						<li><a title="Introduction" href="introduction.html">Introduction</a></li>
						<li><a title="Download" href="download.html">Download</a></li>
						<li><a title="Install" href="install.html">Install</a></li>
						<li><a title="Risks" href="risks.html">Risks</a></li>
					</ul>						
					<h3>VIEWS</h3>
					<ul>
						<li><a title="auto_increment_columns" href="auto_increment_columns.html">auto_increment_columns</a></li>
						<li><a title="data_size_per_engine" href="data_size_per_engine.html">data_size_per_engine</a></li>
						<li><a title="data_size_per_schema" href="data_size_per_schema.html">data_size_per_schema</a></li>


						<li><a title="global_status_diff" href="global_status_diff.html">global_status_diff</a></li>
						<li><a title="global_status_diff_clean" href="global_status_diff_clean.html">global_status_diff_clean</a></li>
						<li><a title="global_status_diff_nonzero" href="global_status_diff_nonzero.html">global_status_diff_nonzero</a></li>

						<li><a title="innodb_locked_transactions" href="innodb_locked_transactions.html">innodb_locked_transactions</a></li>

						<li><a title="innodb_index_rows" href="innodb_index_rows.html">innodb_index_rows</a></li>
						<li><a title="innodb_index_stats" href="innodb_index_stats.html">innodb_index_stats</a></li>

						<li><a title="innodb_simple_locks" href="innodb_simple_locks.html">innodb_simple_locks</a></li>
						<li><a title="innodb_transactions" href="innodb_transactions.html">innodb_transactions</a></li>
						<li><a title="innodb_transactions_summary" href="innodb_transactions_summary.html">innodb_transactions_summary</a></li>

						<li><a title="no_pk_innodb_tables" href="no_pk_innodb_tables.html">no_pk_innodb_tables</a></li>
						
						<li><a title="processlist_per_userhost" href="processlist_per_userhost.html">processlist_per_userhost</a></li>
						<li><a title="processlist_repl" href="processlist_repl.html">processlist_repl</a></li>
						<li><a title="processlist_summary" href="processlist_summary.html">processlist_summary</a></li>
						<li><a title="processlist_top" href="processlist_top.html">processlist_top</a></li>
						
						<li><a title="redundant_keys" href="redundant_keys.html">redundant_keys</a></li>
						<li><a title="routine_privileges" href="routine_privileges.html">routine_privileges</a></li>
						
						<li><a title="sql_alter_table" href="sql_alter_table.html">sql_alter_table</a></li>
						<li><a title="sql_foreign_keys" href="sql_foreign_keys.html">sql_foreign_keys</a></li>
						<li><a title="sql_grants" href="sql_grants.html">sql_grants</a></li>
						<li><a title="sql_show_grants" href="sql_show_grants.html">sql_show_grants</a></li>

						<li><a title="table_charset" href="table_charset.html">table_charset</a></li>
						<li><a title="text_columns" href="text_columns.html">text_columns</a></li>						
					</ul>						
					<h3>TABLES</h3>
					<ul>
						<li><a title="numbers" href="numbers.html">numbers</a></li>
					</ul>						
					<h3>FUNCTIONS</h3>
					<ul>
						<li><a title="General functions" href="general_functions.html">General functions</a></li>
						<li><a title="String functions" href="string_functions.html">String functions</a></li>
						<li><a title="Time & date functions" href="time_functions.html">Time & date functions</a></li>
					</ul>
				</div>
			</div>	
			<div class="clear">&nbsp;</div>
			
			<div id="footnote" align="center">
				<a href="">common_schema</a> documentation
			</div>
		</div>
	</div>
</body>
</html>
